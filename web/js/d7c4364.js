(function(){"use strict";function setup($){$.fn._fadeIn=$.fn.fadeIn;var noOp=$.noop||function(){};var msie=/MSIE/.test(navigator.userAgent);var ie6=/MSIE 6.0/.test(navigator.userAgent)&&!/MSIE 8.0/.test(navigator.userAgent);var mode=document.documentMode||0;var setExpr=$.isFunction(document.createElement("div").style.setExpression);$.blockUI=function(opts){install(window,opts)};$.unblockUI=function(opts){remove(window,opts)};$.growlUI=function(title,message,timeout,onClose){var $m=$('<div class="growlUI"></div>');if(title)$m.append("<h1>"+title+"</h1>");if(message)$m.append("<h2>"+message+"</h2>");if(timeout===undefined)timeout=3e3;var callBlock=function(opts){opts=opts||{};$.blockUI({message:$m,fadeIn:typeof opts.fadeIn!=="undefined"?opts.fadeIn:700,fadeOut:typeof opts.fadeOut!=="undefined"?opts.fadeOut:1e3,timeout:typeof opts.timeout!=="undefined"?opts.timeout:timeout,centerY:false,showOverlay:false,onUnblock:onClose,css:$.blockUI.defaults.growlCSS})};callBlock();var nonmousedOpacity=$m.css("opacity");$m.mouseover(function(){callBlock({fadeIn:0,timeout:3e4});var displayBlock=$(".blockMsg");displayBlock.stop();displayBlock.fadeTo(300,1)}).mouseout(function(){$(".blockMsg").fadeOut(1e3)})};$.fn.block=function(opts){if(this[0]===window){$.blockUI(opts);return this}var fullOpts=$.extend({},$.blockUI.defaults,opts||{});this.each(function(){var $el=$(this);if(fullOpts.ignoreIfBlocked&&$el.data("blockUI.isBlocked"))return;$el.unblock({fadeOut:0})});return this.each(function(){if($.css(this,"position")=="static"){this.style.position="relative";$(this).data("blockUI.static",true)}this.style.zoom=1;install(this,opts)})};$.fn.unblock=function(opts){if(this[0]===window){$.unblockUI(opts);return this}return this.each(function(){remove(this,opts)})};$.blockUI.version=2.7;$.blockUI.defaults={message:"<h1>Attendez s'il vous plaît...</h1>",title:null,draggable:true,theme:false,css:{padding:0,margin:0,width:"40%",top:"40%",left:"35%",textAlign:"center",color:"#000",border:"3px solid #aaa",backgroundColor:"#fff",cursor:"wait"},themedCSS:{width:"30%",top:"40%",left:"35%"},overlayCSS:{backgroundColor:"#000",opacity:.6,cursor:"wait"},cursorReset:"default",growlCSS:{width:"350px",top:"10px",left:"",right:"10px",border:"none",padding:"5px",opacity:.6,cursor:"default",color:"#fff",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px","border-radius":"10px"},iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank",forceIframe:false,baseZ:2018,centerX:true,centerY:true,allowBodyStretch:true,bindEvents:true,constrainTabKey:true,fadeIn:200,fadeOut:400,timeout:0,showOverlay:true,focusInput:true,focusableElements:":input:enabled:visible",onBlock:null,onUnblock:null,onOverlayClick:null,quirksmodeOffsetHack:4,blockMsgClass:"blockMsg",ignoreIfBlocked:false};var pageBlock=null;var pageBlockEls=[];function install(el,opts){var css,themedCSS;var full=el==window;var msg=opts&&opts.message!==undefined?opts.message:undefined;opts=$.extend({},$.blockUI.defaults,opts||{});if(opts.ignoreIfBlocked&&$(el).data("blockUI.isBlocked"))return;opts.overlayCSS=$.extend({},$.blockUI.defaults.overlayCSS,opts.overlayCSS||{});css=$.extend({},$.blockUI.defaults.css,opts.css||{});if(opts.onOverlayClick)opts.overlayCSS.cursor="pointer";themedCSS=$.extend({},$.blockUI.defaults.themedCSS,opts.themedCSS||{});msg=msg===undefined?opts.message:msg;if(full&&pageBlock)remove(window,{fadeOut:0});if(msg&&typeof msg!="string"&&(msg.parentNode||msg.jquery)){var node=msg.jquery?msg[0]:msg;var data={};$(el).data("blockUI.history",data);data.el=node;data.parent=node.parentNode;data.display=node.style.display;data.position=node.style.position;if(data.parent)data.parent.removeChild(node)}$(el).data("blockUI.onUnblock",opts.onUnblock);var z=opts.baseZ;var lyr1,lyr2,lyr3,s;if(msie||opts.forceIframe)lyr1=$('<iframe class="blockUI" style="z-index:'+z+++';display:none;border:none;margin:0;padding:0;position:absolute;width:100%;height:100%;top:0;left:0" src="'+opts.iframeSrc+'"></iframe>');else lyr1=$('<div class="blockUI" style="display:none"></div>');if(opts.theme)lyr2=$('<div class="blockUI blockOverlay ui-widget-overlay" style="z-index:'+z+++';display:none"></div>');else lyr2=$('<div class="blockUI blockOverlay" style="z-index:'+z+++';display:none;border:none;margin:0;padding:0;width:100%;height:100%;top:0;left:0"></div>');if(opts.theme&&full){s='<div class="blockUI '+opts.blockMsgClass+' blockPage ui-dialog ui-widget ui-corner-all" style="z-index:'+(z+10)+';display:none;position:fixed">';if(opts.title){s+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(opts.title||"&nbsp;")+"</div>"}s+='<div class="ui-widget-content ui-dialog-content"></div>';s+="</div>"}else if(opts.theme){s='<div class="blockUI '+opts.blockMsgClass+' blockElement ui-dialog ui-widget ui-corner-all" style="z-index:'+(z+10)+';display:none;position:absolute">';if(opts.title){s+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(opts.title||"&nbsp;")+"</div>"}s+='<div class="ui-widget-content ui-dialog-content"></div>';s+="</div>"}else if(full){s='<div class="blockUI '+opts.blockMsgClass+' blockPage" style="z-index:'+(z+10)+';display:none;position:fixed"></div>'}else{s='<div class="blockUI '+opts.blockMsgClass+' blockElement" style="z-index:'+(z+10)+';display:none;position:absolute"></div>'}lyr3=$(s);if(msg){if(opts.theme){lyr3.css(themedCSS);lyr3.addClass("ui-widget-content")}else lyr3.css(css)}if(!opts.theme)lyr2.css(opts.overlayCSS);lyr2.css("position",full?"fixed":"absolute");if(msie||opts.forceIframe)lyr1.css("opacity",0);var layers=[lyr1,lyr2,lyr3],$par=full?$("body"):$(el);$.each(layers,function(){this.appendTo($par)});if(opts.theme&&opts.draggable&&$.fn.draggable){lyr3.draggable({handle:".ui-dialog-titlebar",cancel:"li"})}var expr=setExpr&&(!$.support.boxModel||$("object,embed",full?null:el).length>0);if(ie6||expr){if(full&&opts.allowBodyStretch&&$.support.boxModel)$("html,body").css("height","100%");if((ie6||!$.support.boxModel)&&!full){var t=sz(el,"borderTopWidth"),l=sz(el,"borderLeftWidth");var fixT=t?"(0 - "+t+")":0;var fixL=l?"(0 - "+l+")":0}$.each(layers,function(i,o){var s=o[0].style;s.position="absolute";if(i<2){if(full)s.setExpression("height","Math.max(document.body.scrollHeight, document.body.offsetHeight) - (jQuery.support.boxModel?0:"+opts.quirksmodeOffsetHack+') + "px"');else s.setExpression("height",'this.parentNode.offsetHeight + "px"');if(full)s.setExpression("width",'jQuery.support.boxModel && document.documentElement.clientWidth || document.body.clientWidth + "px"');else s.setExpression("width",'this.parentNode.offsetWidth + "px"');if(fixL)s.setExpression("left",fixL);if(fixT)s.setExpression("top",fixT)}else if(opts.centerY){if(full)s.setExpression("top",'(document.documentElement.clientHeight || document.body.clientHeight) / 2 - (this.offsetHeight / 2) + (blah = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"');s.marginTop=0}else if(!opts.centerY&&full){var top=opts.css&&opts.css.top?parseInt(opts.css.top,10):0;var expression="((document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "+top+') + "px"';s.setExpression("top",expression)}})}if(msg){if(opts.theme)lyr3.find(".ui-widget-content").append(msg);else lyr3.append(msg);if(msg.jquery||msg.nodeType)$(msg).show()}if((msie||opts.forceIframe)&&opts.showOverlay)lyr1.show();if(opts.fadeIn){var cb=opts.onBlock?opts.onBlock:noOp;var cb1=opts.showOverlay&&!msg?cb:noOp;var cb2=msg?cb:noOp;if(opts.showOverlay)lyr2._fadeIn(opts.fadeIn,cb1);if(msg)lyr3._fadeIn(opts.fadeIn,cb2)}else{if(opts.showOverlay)lyr2.show();if(msg)lyr3.show();if(opts.onBlock)opts.onBlock.bind(lyr3)()}bind(1,el,opts);if(full){pageBlock=lyr3[0];pageBlockEls=$(opts.focusableElements,pageBlock);if(opts.focusInput)setTimeout(focus,20)}else center(lyr3[0],opts.centerX,opts.centerY);if(opts.timeout){var to=setTimeout(function(){if(full)$.unblockUI(opts);else $(el).unblock(opts)},opts.timeout);$(el).data("blockUI.timeout",to)}}function remove(el,opts){var count;var full=el==window;var $el=$(el);var data=$el.data("blockUI.history");var to=$el.data("blockUI.timeout");if(to){clearTimeout(to);$el.removeData("blockUI.timeout")}opts=$.extend({},$.blockUI.defaults,opts||{});bind(0,el,opts);if(opts.onUnblock===null){opts.onUnblock=$el.data("blockUI.onUnblock");$el.removeData("blockUI.onUnblock")}var els;if(full)els=$("body").children().filter(".blockUI").add("body > .blockUI");else els=$el.find(">.blockUI");if(opts.cursorReset){if(els.length>1)els[1].style.cursor=opts.cursorReset;if(els.length>2)els[2].style.cursor=opts.cursorReset}if(full)pageBlock=pageBlockEls=null;if(opts.fadeOut){count=els.length;els.stop().fadeOut(opts.fadeOut,function(){if(--count===0)reset(els,data,opts,el)})}else reset(els,data,opts,el)}function reset(els,data,opts,el){var $el=$(el);if($el.data("blockUI.isBlocked"))return;els.each(function(i,o){if(this.parentNode)this.parentNode.removeChild(this)});if(data&&data.el){data.el.style.display=data.display;data.el.style.position=data.position;data.el.style.cursor="default";if(data.parent)data.parent.appendChild(data.el);$el.removeData("blockUI.history")}if($el.data("blockUI.static")){$el.css("position","static")}if(typeof opts.onUnblock=="function")opts.onUnblock(el,opts);var body=$(document.body),w=body.width(),cssW=body[0].style.width;body.width(w-1).width(w);body[0].style.width=cssW}function bind(b,el,opts){var full=el==window,$el=$(el);if(!b&&(full&&!pageBlock||!full&&!$el.data("blockUI.isBlocked")))return;$el.data("blockUI.isBlocked",b);if(!full||!opts.bindEvents||b&&!opts.showOverlay)return;var events="mousedown mouseup keydown keypress keyup touchstart touchend touchmove";if(b)$(document).bind(events,opts,handler);else $(document).unbind(events,handler)}function handler(e){if(e.type==="keydown"&&e.keyCode&&e.keyCode==9){if(pageBlock&&e.data.constrainTabKey){var els=pageBlockEls;var fwd=!e.shiftKey&&e.target===els[els.length-1];var back=e.shiftKey&&e.target===els[0];if(fwd||back){setTimeout(function(){focus(back)},10);return false}}}var opts=e.data;var target=$(e.target);if(target.hasClass("blockOverlay")&&opts.onOverlayClick)opts.onOverlayClick(e);if(target.parents("div."+opts.blockMsgClass).length>0)return true;return target.parents().children().filter("div.blockUI").length===0}function focus(back){if(!pageBlockEls)return;var e=pageBlockEls[back===true?pageBlockEls.length-1:0];if(e)e.focus()}function center(el,x,y){var p=el.parentNode,s=el.style;var l=(p.offsetWidth-el.offsetWidth)/2-sz(p,"borderLeftWidth");var t=(p.offsetHeight-el.offsetHeight)/2-sz(p,"borderTopWidth");if(x)s.left=l>0?l+"px":"0";if(y)s.top=t>0?t+"px":"0"}function sz(el,p){return parseInt($.css(el,p),10)||0}}if(typeof define==="function"&&define.amd&&define.amd.jQuery){define(["jquery"],setup)}else{setup(jQuery)}})();
(function($){$.extend({debounce:function(fn,timeout,invokeAsap,ctx){if(arguments.length==3&&typeof invokeAsap!="boolean"){ctx=invokeAsap;invokeAsap=false}var timer;return function(){var args=arguments;ctx=ctx||this;invokeAsap&&!timer&&fn.apply(ctx,args);clearTimeout(timer);timer=setTimeout(function(){invokeAsap||fn.apply(ctx,args);timer=null},timeout)}},throttle:function(fn,timeout,ctx){var timer,args,needInvoke;return function(){args=arguments;needInvoke=true;ctx=ctx||this;timer||function(){if(needInvoke){fn.apply(ctx,args);needInvoke=false;timer=setTimeout(arguments.callee,timeout)}else{timer=null}}()}}})})(jQuery);
$(function(){var locations=[];firstTime();var map;var markers=[];var infowindow;var markerCluster;var currentRequest=null;var xhr=null;var blockableElement=null;var perform=false;var last_phrases="";var is_processing=false;var last_page=false;var add_more=false;var first=true;var show_offre=true;function fillMap(){var marker,i;for(i=0;i<locations.length;i++){marker=new google.maps.Marker({position:new google.maps.LatLng(locations[i].latitude,locations[i].longitude),map:map,scaledSize:new google.maps.Size(22,32),icon:assetsBaseDir+"m2m.png"});attachSecretMessage(marker,locations[i]);markers.push(marker)}markerCluster=new MarkerClusterer(map,markers,{imagePath:assetsBaseDir+"m"})}function attachSecretMessage(marker,secretMessage){marker.addListener("click",function(){$("#offreList").children().remove();showOffre(secretMessage.id)})}function firstTime(){infowindow=new google.maps.InfoWindow;$.ajax({url:Routing.generate("eco_job_anonymous_offre_search_ajax_templated"),type:"GET",contentType:"application/json",contentType:false,success:function(response){response=$.parseJSON(response.objects);locations=response},error:function(){alert("Echec lors de la connexion au serveur. Veuillez réessayer ou contacter l'administrateur")}}).done(function(response){initialize()})}function initialize(){var mapOptions={center:new google.maps.LatLng(46.9,1.56),zoom:6,mapTypeId:google.maps.MapTypeId.ROADMAP,zoomControl:true,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL},gestureHandling:"greedy",styles:[{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#444444"}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#f2f2f2"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"all",stylers:[{saturation:-100},{lightness:45}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"all",stylers:[{color:"#01a2a6"},{visibility:"on"}]}]};map=new google.maps.Map(document.getElementById("google_map"),mapOptions);fillMap()}function removeMarkers(){for(var i=0;i<markers.length;i++){markers[i].setMap(null)}markers.length=0;markerCluster.clearMarkers()}function showOffre(id){$.ajax({url:Routing.generate("eco_job_anonymous_offre_details",{id:id}),type:"GET",dataType:"json",contentType:"application/json",beforeSend:function(){resetDiv();$("#details").append("<div class='loader'></div>")},beforeSend:function(){if(blockableElement==null)blockableElement=$("#google_map").block({message:"<div class='loader'></div>",css:{border:"none",backgroundColor:"transparent",width:"66px"}});else{if(!blockableElement.data("blockUI.isBlocked"))blockableElement=$("#google_map").block({message:"<div class='loader'></div>",css:{border:"none",backgroundColor:"transparent",width:"66px"}})}if(xhr!=null)xhr.abort()},contentType:false,statusCode:{200:function(response){resetDiv();$("#offreList").children().remove();$("#offreList").append(response.list);$("#details").append(response.html);var marker=new google.maps.Marker({position:new google.maps.LatLng(response.lat,response.long),map:map,scaledSize:new google.maps.Size(22,32),icon:assetsBaseDir+"m2m.png"});map.setZoom(17);map.panTo(new google.maps.LatLng(response.lat,response.long));google.maps.event.addListener(marker,"click",function(){return function(){infowindow.setContent(response.titre);showOffre(response.id)}})},412:function(response){resetDiv();$("#details").append("Echec de la connexion au serveur")},500:function(response){resetDiv();$("#details").append("Echec de la connexion au serveur")}},complete:function(){$("#google_map").unblock()}})}$(document).on("click",".offre",function(){showOffre($(this).attr("offreId"));show_offre=true});$(document).on("click",".save",function(){$("#globModal").modal("show")});function getOffres(){$.ajax({url:Routing.generate("eco_job_anonymous_offres_json"),type:"GET",contentType:"application/json",contentType:false,success:function(response){response=$.parseJSON(response);locations=response},error:function(){alert("Echec lors de la connexion au serveur. Veuillez réessayer ou contacter l'administrateur")}})}function resetDiv(){$("#details").children().remove();$("#details").empty()}function resetList(){$("#offreList").children().remove();$("#offreList").empty()}var options={target:"#details",async:false,cache:false,beforeSubmit:showRequest,success:showResponse,url:Routing.generate("eco_job_anonymous_offre_search_ajax_templated"),type:"post",dataType:"json"};$("#searchForm").submit(function(){$("#searchForm").ajaxSubmit(options);return false});$("#searchBar").keyup($.debounce(flushSearch,500));$("#localisation").keyup($.debounce(flushSearch,500));$("#langues").keyup($.debounce(flushSearch,500));$("#niveauDiplome").keyup($.debounce(flushSearch,500));$("#prerequis").keyup($.debounce(flushSearch,500));$("#avantages").keyup($.debounce(flushSearch,500));function flushSearch(){var val=$("#searchBar").val();if(val.length>=3||val.length==0&&last_phrases!=val){currentRequest=performSearch();last_phrases=this.value}}$("#datePublication").on("change",function(){currentRequest=performSearch()});$("#secteur").on("change",function(){currentRequest=performSearch()});$("#contrat").on("change",function(){currentRequest=performSearch()});$("#limit").on("change",function(){currentRequest=performSearch()});$("#reset").click(function(e){e.preventDefault();resetDiv();removeMarkers();locations=[];var mapOptions={center:new google.maps.LatLng(46.9,1.56),zoom:6,mapTypeId:google.maps.MapTypeId.ROADMAP,zoomControl:true,gestureHandling:"greedy",zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL},styles:[{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#444444"}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#f2f2f2"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"all",stylers:[{saturation:-100},{lightness:45}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"all",stylers:[{color:"#01a2a6"},{visibility:"on"}]}]};map=new google.maps.Map(document.getElementById("google_map"),mapOptions);markerCluster=new MarkerClusterer(map,markers,{imagePath:"../../../images/m"});resetForm()});function showRequest(formData,jqForm,options){perform=true}function showResponse(responseText,statusText,xhr,$form){var resultats=$.parseJSON(responseText.objects);xhr=null;perform=false;if(!show_offre)removeMarkers();if(add_more){console.log(locations);if(resultats.length>0){for(var i=0;i<resultats.length;i++){locations.push(resultats[i])}}console.log(locations)}else{locations=[];locations=resultats;resetList();resetDiv()}fillMap();$("#google_map").unblock();if(!add_more){resetDiv();if(responseText.total>0){resetDiv();$("#offreList").append("<div class='title6' id='res'>Résultats  <br> Total: "+responseText.total+"</div>");$("#offreList").append(responseText.html)}else{if(!first){var html="<div class='news1'><div class='txt2'>Aucune offre d'emploi trouvée</div><div class='txt3'></div></div>";resetDiv();$("#offreList").append(html)}}$("#offreList").on("scroll",$.debounce(addMore,500))}else{$(".loader").remove();$("#offreList").unblock();if(responseText.total>0){$("#offreList").append(responseText.html);$("#offreList").on("scroll",$.debounce(addMore,500))}else{console.log("last_page");console.log(responseText);last_page=true;$("#offreList").append("Fin de la correspondance")}}loadCards();loadNetworks();IN.parse()}function resetForm(){$("#datePublication").val("-1");$("#contrat").val("0");$("#secteur").val("0");$("#searchBar").val("");$("#limit").val("20");currentRequest=performSearch()}function performSearch(){$("#offreList").children().remove().append("<div class='loader'></div>");$("#offreList").append("<div class='loader'></div>");add_more=false;is_processing=false;last_page=false;show_offre=false;first=false;$("#offset").val(0);$("#offreList").scrollTop(0);if(blockableElement==null)blockableElement=$("#google_map").block({message:"<div class='loader'></div>",css:{border:"none",backgroundColor:"transparent",width:"66px"}});else{if(!blockableElement.data("blockUI.isBlocked"))blockableElement=$("#google_map").block({message:"<div class='loader'></div>",css:{border:"none",backgroundColor:"transparent",width:"66px"}})}if(xhr!=null)xhr.abort();removeMarkers();locations=[];var form=$("#searchForm").submit();xhr=form.data("jqxhr")}$("#offreList").scroll($.debounce(addMore,500));$(document).on("click",".save",function(){$("#globModal").modal("show")});function addMore(){if($(this).scrollTop()+$(this).innerHeight()==$(this)[0].scrollHeight){if(!(is_processing&&last_page)){$("#offreList").off("scroll");$("#offreList").append("<div class='loader'></div>").scrollTop($(this)[0].scrollHeight);first=false;add_more=true;is_processing=true;var currOffset=parseInt($("#offset").val());var limit=parseInt($("#limit").val());$("#offset").val(currOffset+limit);if(xhr!=null)xhr.abort();var form=$("#searchForm").submit();xhr=form.data("jqxhr")}}}function loadCards(){var cartWrapper=$(".cd-cart-container");var productId=0;if(cartWrapper.length>0){var cartBody=cartWrapper.find(".body");var cartList=cartBody.find("ul").eq(0);var cartTotal=cartWrapper.find(".checkout").find("span");var cartTrigger=cartWrapper.children(".cd-cart-trigger");var cartCount=cartTrigger.children(".count");var addToCartBtn=$(".cd-add-to-cart");var undo=cartWrapper.find(".undo");var undoTimeoutId;addToCartBtn.on("click",function(event){event.preventDefault();addToCart($(this));animate($(this))});cartTrigger.on("click",function(event){event.preventDefault();toggleCart(true)});cartWrapper.on("click",function(event){if($(event.target).is($(this)))toggleCart(true)});cartList.on("click",".delete-item",function(event){event.preventDefault();removeProduct($(event.target).parents(".product"))});cartList.on("change","select",function(event){quickUpdateCart()});undo.on("click","a",function(event){clearInterval(undoTimeoutId);event.preventDefault();cartList.find(".deleted").addClass("undo-deleted").one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(){$(this).off("webkitAnimationEnd oanimationend msAnimationEnd animationend").removeClass("deleted undo-deleted").removeAttr("style");quickUpdateCart()});undo.removeClass("visible")})}function toggleCart(bool){var cartIsOpen=typeof bool==="undefined"?cartWrapper.hasClass("cart-open"):bool;if(cartIsOpen){cartWrapper.removeClass("cart-open");clearInterval(undoTimeoutId);undo.removeClass("visible");cartList.find(".deleted").remove();setTimeout(function(){cartBody.scrollTop(0);cartWrapper.addClass("empty")},500)}else{cartWrapper.addClass("cart-open")}}function addToCart(trigger){var cartIsEmpty=cartWrapper.hasClass("empty");var _offreId=trigger.data("offre-id");addProduct(cartIsEmpty,_offreId).complete(function(){cartWrapper.removeClass("empty");trigger.replaceWith('<a href="#" class="btn-default btn-warning">Déja sauvegardée</a>');toggleCart(true)})}function animate(trigger){var imgtodrag=trigger;if(imgtodrag){var imgclone=imgtodrag.clone().offset({top:imgtodrag.offset().top,left:imgtodrag.offset().left}).css({opacity:"0.5",position:"absolute",height:"150px",width:"150px","z-index":"100"}).appendTo($("body")).animate({top:cartTrigger.offset().top-150,left:cartTrigger.offset().left,width:75,height:75},3e3,"easeInOutExpo");setTimeout(function(){cartTrigger.effect("shake",{times:2},200)},1500);imgclone.animate({width:0,height:0},function(){$(this).detach()})}else{alert("not defined")}}function addProduct(cartIsEmpty,id){var xhr=$.ajax({url:Routing.generate("eco_job_candidat_offre_save_async",{id:id}),method:"GET"}).success(function(data){updateCartCount(cartIsEmpty,data.saved)}).error(function(err){console.warn(err)});return xhr}function removeProduct(product){clearInterval(undoTimeoutId);cartList.find(".deleted").remove();var topPosition=product.offset().top-cartBody.children("ul").offset().top,productQuantity=Number(product.find(".quantity").find("select").val()),productTotPrice=Number(product.find(".price").text().replace("$",""))*productQuantity;product.css("top",topPosition+"px").addClass("deleted");updateCartCount(true,-productQuantity);undo.addClass("visible");undoTimeoutId=setTimeout(function(){undo.removeClass("visible");cartList.find(".deleted").remove()},8e3)}function quickUpdateCart(){var quantity=0;var price=0;cartList.children("li:not(.deleted)").each(function(){var singleQuantity=Number($(this).find("select").val());quantity=quantity+singleQuantity;price=price+singleQuantity*Number($(this).find(".price").text().replace("$",""))});cartTotal.text(price.toFixed(2));cartCount.find("li").eq(0).text(quantity);cartCount.find("li").eq(1).text(quantity+1)}function updateCartCount(emptyCart,quantity){cartCount.find("li").eq(0).text(quantity);cartCount.find("li").eq(1).text(quantity)}}function loadNetworks(){var _url=window.location.href;window.fbAsyncInit=function(){FB.init({appId:"1750551898578027",xfbml:true,version:"v2.10"});FB.AppEvents.logPageView()};(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(d.getElementById(id)){return}js=d.createElement(s);js.id=id;js.src="//connect.facebook.net/en_US/sdk.js";fjs.parentNode.insertBefore(js,fjs)})(document,"script","facebook-jssdk");$(".fb-share").click(function(e){e.preventDefault();var url="ecojob.fr/valfid/developpement/web"+$(this).attr("href");FB.ui({method:"share",display:"popup",href:url},function(response){});return false});$(".popup").click(function(event){var width=575,height=400,left=($(window).width()-width)/2,top=($(window).height()-height)/2,url=this.href,opts="status=1"+",width="+width+",height="+height+",top="+top+",left="+left;window.open(url,"twitter",opts);return false});$("#candidatureForm").submit(function(event){event.preventDefault();var form_data=$(this).serialize();console.log(form_data);$.ajax({type:"POST",url:$(this).attr("action"),data:form_data,beforeSend:function(){$.blockUI({message:'<p class="loader"></p>',css:{border:"none",backgroundColor:"transparent",width:"66px",top:($(window).height()-100)/2+"px",left:($(window).width()-100)/2+"px"}})},error:function(err){$("#responseStore").addClass("alert-danger").html("L'envoie de votre candidature a échoué").show()},success:function(data){$("#responseStore").addClass("alert-success").html(data.message).show();$("#postulerBtn").replaceWith('<a href="#" class="btn-default btn-warning">Déja postulé</a>');$("#m-m-u").modal("hide")},complete:function(){$.unblockUI()}})})}});
$(function(){var _url=window.location.href;window.fbAsyncInit=function(){FB.init({appId:"1750551898578027",xfbml:true,version:"v2.10"});FB.AppEvents.logPageView()};(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(d.getElementById(id)){return}js=d.createElement(s);js.id=id;js.src="//connect.facebook.net/en_US/sdk.js";fjs.parentNode.insertBefore(js,fjs)})(document,"script","facebook-jssdk");$(".fb-share").click(function(e){e.preventDefault();var url="ecojob.fr/valfid/developpement/web"+$(this).attr("href");FB.ui({method:"share",display:"popup",href:url},function(response){});return false});$(".popup").click(function(event){var width=575,height=400,left=($(window).width()-width)/2,top=($(window).height()-height)/2,url=this.href,opts="status=1"+",width="+width+",height="+height+",top="+top+",left="+left;window.open(url,"twitter",opts);return false});$("#candidatureForm").submit(function(event){event.preventDefault();var form_data=$(this).serialize();console.log(form_data);$.ajax({type:"POST",url:$(this).attr("action"),data:form_data,beforeSend:function(){$.blockUI({message:'<p class="loader"></p>',css:{border:"none",backgroundColor:"transparent",width:"66px",top:($(window).height()-100)/2+"px",left:($(window).width()-100)/2+"px"}})},error:function(err){$("#responseStore").addClass("alert-danger").html("L'envoie de votre candidature a échoué").show()},success:function(data){$("#responseStore").addClass("alert-success").html(data.message).show();$("#postulerBtn").replaceWith('<a href="#" class="btn-default btn-warning">Déja postulé</a>');$("#m-m-u").modal("hide")},complete:function(){$.unblockUI()}})})});
jQuery(document).ready(function($){var cartWrapper=$(".cd-cart-container");var productId=0;if(cartWrapper.length>0){var cartBody=cartWrapper.find(".body");var cartList=cartBody.find("ul").eq(0);var cartTotal=cartWrapper.find(".checkout").find("span");var cartTrigger=cartWrapper.children(".cd-cart-trigger");var cartCount=cartTrigger.children(".count");var addToCartBtn=$(".cd-add-to-cart");var undo=cartWrapper.find(".undo");var undoTimeoutId;$(document).on("click",".cd-add-to-cart",function(event){event.preventDefault();addToCart($(this));animate($(this))});cartTrigger.on("click",function(event){event.preventDefault();toggleCart(true)});cartWrapper.on("click",function(event){if($(event.target).is($(this)))toggleCart(true)});cartList.on("click",".delete-item",function(event){event.preventDefault();removeProduct($(event.target).parents(".product"))});cartList.on("change","select",function(event){quickUpdateCart()});undo.on("click","a",function(event){clearInterval(undoTimeoutId);event.preventDefault();cartList.find(".deleted").addClass("undo-deleted").one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(){$(this).off("webkitAnimationEnd oanimationend msAnimationEnd animationend").removeClass("deleted undo-deleted").removeAttr("style");quickUpdateCart()});undo.removeClass("visible")})}function toggleCart(bool){var cartIsOpen=typeof bool==="undefined"?cartWrapper.hasClass("cart-open"):bool;if(cartIsOpen){cartWrapper.removeClass("cart-open");clearInterval(undoTimeoutId);undo.removeClass("visible");cartList.find(".deleted").remove();setTimeout(function(){cartBody.scrollTop(0);cartWrapper.addClass("empty")},500)}else{cartWrapper.addClass("cart-open")}}function addToCart(trigger){var cartIsEmpty=cartWrapper.hasClass("empty");var _offreId=trigger.data("offre-id");addProduct(cartIsEmpty,_offreId).complete(function(){cartWrapper.removeClass("empty");toggleCart(true)})}function animate(trigger){var imgtodrag=trigger;if(imgtodrag){var imgclone=imgtodrag.clone().offset({top:imgtodrag.offset().top,left:imgtodrag.offset().left}).css({opacity:"0.5",position:"absolute",height:"150px",width:"150px","z-index":"100"}).appendTo($("body")).animate({top:cartTrigger.offset().top-150,left:cartTrigger.offset().left,width:75,height:75},3e3,"easeInOutExpo");imgclone.animate({width:0,height:0},function(){$(this).detach()})}else{alert("not defined")}}function addProduct(cartIsEmpty,id){var xhr=$.ajax({url:Routing.generate("eco_job_candidat_offre_save_async",{id:id}),method:"GET"}).success(function(data){$(".cd-add-to-cart[data-offre-id="+id+"]").replaceWith('<a href="#" class="btn-default btn-warning">Déja sauvegardée</a>');updateCartCount(cartIsEmpty,data.saved)}).error(function(err){console.warn(err)});return xhr}function removeProduct(product){clearInterval(undoTimeoutId);cartList.find(".deleted").remove();var topPosition=product.offset().top-cartBody.children("ul").offset().top,productQuantity=Number(product.find(".quantity").find("select").val()),productTotPrice=Number(product.find(".price").text().replace("$",""))*productQuantity;product.css("top",topPosition+"px").addClass("deleted");updateCartCount(true,-productQuantity);undo.addClass("visible");undoTimeoutId=setTimeout(function(){undo.removeClass("visible");cartList.find(".deleted").remove()},8e3)}function quickUpdateCart(){var quantity=0;var price=0;cartList.children("li:not(.deleted)").each(function(){var singleQuantity=Number($(this).find("select").val());quantity=quantity+singleQuantity;price=price+singleQuantity*Number($(this).find(".price").text().replace("$",""))});cartTotal.text(price.toFixed(2));cartCount.find("li").eq(0).text(quantity);cartCount.find("li").eq(1).text(quantity+1)}function updateCartCount(emptyCart,quantity){cartCount.find("li").eq(0).text(quantity);cartCount.find("li").eq(1).text(quantity)}});
jQuery.easing["jswing"]=jQuery.easing["swing"];jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(x,t,b,c,d){return jQuery.easing[jQuery.easing.def](x,t,b,c,d)},easeInQuad:function(x,t,b,c,d){return c*(t/=d)*t+b},easeOutQuad:function(x,t,b,c,d){return-c*(t/=d)*(t-2)+b},easeInOutQuad:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t+b;return-c/2*(--t*(t-2)-1)+b},easeInCubic:function(x,t,b,c,d){return c*(t/=d)*t*t+b},easeOutCubic:function(x,t,b,c,d){return c*((t=t/d-1)*t*t+1)+b},easeInOutCubic:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t*t+b;return c/2*((t-=2)*t*t+2)+b},easeInQuart:function(x,t,b,c,d){return c*(t/=d)*t*t*t+b},easeOutQuart:function(x,t,b,c,d){return-c*((t=t/d-1)*t*t*t-1)+b},easeInOutQuart:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t*t*t+b;return-c/2*((t-=2)*t*t*t-2)+b},easeInQuint:function(x,t,b,c,d){return c*(t/=d)*t*t*t*t+b},easeOutQuint:function(x,t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b},easeInOutQuint:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t*t*t*t+b;return c/2*((t-=2)*t*t*t*t+2)+b},easeInSine:function(x,t,b,c,d){return-c*Math.cos(t/d*(Math.PI/2))+c+b},easeOutSine:function(x,t,b,c,d){return c*Math.sin(t/d*(Math.PI/2))+b},easeInOutSine:function(x,t,b,c,d){return-c/2*(Math.cos(Math.PI*t/d)-1)+b},easeInExpo:function(x,t,b,c,d){return t==0?b:c*Math.pow(2,10*(t/d-1))+b},easeOutExpo:function(x,t,b,c,d){return t==d?b+c:c*(-Math.pow(2,-10*t/d)+1)+b},easeInOutExpo:function(x,t,b,c,d){if(t==0)return b;if(t==d)return b+c;if((t/=d/2)<1)return c/2*Math.pow(2,10*(t-1))+b;return c/2*(-Math.pow(2,-10*--t)+2)+b},easeInCirc:function(x,t,b,c,d){return-c*(Math.sqrt(1-(t/=d)*t)-1)+b},easeOutCirc:function(x,t,b,c,d){return c*Math.sqrt(1-(t=t/d-1)*t)+b},easeInOutCirc:function(x,t,b,c,d){if((t/=d/2)<1)return-c/2*(Math.sqrt(1-t*t)-1)+b;return c/2*(Math.sqrt(1-(t-=2)*t)+1)+b},easeInElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0)return b;if((t/=d)==1)return b+c;if(!p)p=d*.3;if(a<Math.abs(c)){a=c;var s=p/4}else var s=p/(2*Math.PI)*Math.asin(c/a);return-(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b},easeOutElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0)return b;if((t/=d)==1)return b+c;if(!p)p=d*.3;if(a<Math.abs(c)){a=c;var s=p/4}else var s=p/(2*Math.PI)*Math.asin(c/a);return a*Math.pow(2,-10*t)*Math.sin((t*d-s)*(2*Math.PI)/p)+c+b},easeInOutElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0)return b;if((t/=d/2)==2)return b+c;if(!p)p=d*(.3*1.5);if(a<Math.abs(c)){a=c;var s=p/4}else var s=p/(2*Math.PI)*Math.asin(c/a);if(t<1)return-.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b;return a*Math.pow(2,-10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*.5+c+b},easeInBack:function(x,t,b,c,d,s){if(s==undefined)s=1.70158;return c*(t/=d)*t*((s+1)*t-s)+b},easeOutBack:function(x,t,b,c,d,s){if(s==undefined)s=1.70158;return c*((t=t/d-1)*t*((s+1)*t+s)+1)+b},easeInOutBack:function(x,t,b,c,d,s){if(s==undefined)s=1.70158;if((t/=d/2)<1)return c/2*(t*t*(((s*=1.525)+1)*t-s))+b;return c/2*((t-=2)*t*(((s*=1.525)+1)*t+s)+2)+b},easeInBounce:function(x,t,b,c,d){return c-jQuery.easing.easeOutBounce(x,d-t,0,c,d)+b},easeOutBounce:function(x,t,b,c,d){if((t/=d)<1/2.75){return c*(7.5625*t*t)+b}else if(t<2/2.75){return c*(7.5625*(t-=1.5/2.75)*t+.75)+b}else if(t<2.5/2.75){return c*(7.5625*(t-=2.25/2.75)*t+.9375)+b}else{return c*(7.5625*(t-=2.625/2.75)*t+.984375)+b}},easeInOutBounce:function(x,t,b,c,d){if(t<d/2)return jQuery.easing.easeInBounce(x,t*2,0,c,d)*.5+b;return jQuery.easing.easeOutBounce(x,t*2-d,0,c,d)*.5+c*.5+b}});
!function(e){e.fn.richText=function(t){function a(){var t,a,n="";S.useParagraph!==!1&&document.execCommand("DefaultParagraphSeparator",!1,"p"),"TEXTAREA"===R.prop("tagName")||(R.val()?(t=R.val(),a=R.prop("attributes"),e.each(a,function(){this.name&&(n+=" "+this.name+'="'+this.value+'"')}),R.replaceWith(e("<textarea"+n+' data-richtext="init">'+t+"</textarea>")),R=e('[data-richtext="init"]'),R.removeAttr("data-richtext")):R.html()?(t=R.html(),a=R.prop("attributes"),e.each(a,function(){this.name&&(n+=" "+this.name+'="'+this.value+'"')}),R.replaceWith(e("<textarea"+n+' data-richtext="init">'+t+"</textarea>")),R=e('[data-richtext="init"]'),R.removeAttr("data-richtext")):(a=R.prop("attributes"),e.each(a,function(){this.name&&(n+=" "+this.name+'="'+this.value+'"')}),R.replaceWith(e("<textarea"+n+' data-richtext="init"></textarea>')),R=e('[data-richtext="init"]'),R.removeAttr("data-richtext"))),L=e("<div />",{class:"richText"});var i=e("<div />",{class:"richText-toolbar"}),r=e("<div />",{class:"richText-editor",id:re,contenteditable:!0});if(i.append(U),S.bold===!0&&U.append(D.clone().append(A)),S.italic===!0&&U.append(D.clone().append(F)),S.underline===!0&&U.append(D.clone().append(H)),S.leftAlign===!0&&U.append(D.clone().append(I)),S.centerAlign===!0&&U.append(D.clone().append(B)),S.rightAlign===!0&&U.append(D.clone().append(M)),S.ol===!0&&U.append(D.clone().append(E)),S.ul===!0&&U.append(D.clone().append(P)),S.fonts===!0&&S.fontList.length>0&&U.append(D.clone().append(X)),S.heading===!0&&U.append(D.clone().append(W)),S.fontColor===!0&&U.append(D.clone().append(Y)),S.imageUpload===!0&&U.append(D.clone().append(Q)),S.fileUpload===!0&&U.append(D.clone().append(_)),S.videoEmbed===!0&&U.append(D.clone().append(z)),S.urls===!0&&U.append(D.clone().append(V)),S.table===!0&&U.append(D.clone().append(G)),S.removeStyles===!0&&U.append(D.clone().append(O)),S.code===!0&&U.append(D.clone().append(j)),r.html(R.val()),L.append(i),L.append(r),L.append(R.clone().hide()),R.replaceWith(L),L.append(e("<div />",{class:"richText-toolbar"}).append(e("<a />",{class:"richText-undo is-disabled",html:'<span class="fa fa-undo"></span>'})).append(e("<a />",{class:"richText-redo is-disabled",html:'<span class="fa fa-repeat"></span>'})).append(e("<a />",{class:"richText-help",html:'<span class="fa fa-question-circle"></span>'}))),S.height&&S.height>0)L.children(".richText-editor, .richText-initial").css({"min-height":S.height+"px",height:S.height+"px"});else if(S.heightPercentage&&S.heightPercentage>0){var o=L.parent().innerHeight(),l=S.heightPercentage/100*o;l-=2*i.outerHeight(),l-=parseInt(L.css("margin-top")),l-=parseInt(L.css("margin-bottom")),l-=parseInt(L.find(".richText-editor").css("padding-top")),l-=parseInt(L.find(".richText-editor").css("padding-bottom")),L.children(".richText-editor, .richText-initial").css({"min-height":l+"px",height:l+"px"})}S["class"]&&L.addClass(S["class"]),S.id&&L.attr("id",S.id),y(),le.push(L.find("textarea").val())}function n(e,t){"undefined"==typeof t&&(t=null),m(),"heading"===e&&s()?g("<"+t+">"+s()+"</"+t+">"):document.execCommand(e,!1,t)}function i(){var t=e("#"+re),a=t.html();S.useSingleQuotes===!0&&(a=v(a)),t.siblings(".richText-initial").val(a)}function r(t){var a=e("#"+t),n=a.siblings(".richText-initial").val();a.html(n)}function o(t){var a,n,i,r,o=document.getElementById(t);if(window.getSelection&&document.createRange){var l=window.getSelection&&window.getSelection();if(l&&l.rangeCount>0&&e(l.anchorNode).parents("#"+t).length>0){var a=window.getSelection().getRangeAt(0),d=a.cloneRange();return d.selectNodeContents(o),d.setEnd(a.startContainer,a.startOffset),n=d.toString().length,i=n+a.toString().length,r=n===i?"caret":"selection",anchor="caret"===r&&l.anchorNode.tagName?l.anchorNode:!1,n="caret"===r&&anchor!==!1?0:d.toString().length,i="caret"===r&&anchor!==!1?0:n+a.toString().length,{start:n,end:i,type:r,anchor:anchor,editorID:t}}}return k?k:{start:0,end:0}}function l(e){var t=document.getElementById(e),a=k;if(a.editorID!==e)return!1;if(t=a.anchor?a.anchor:t,window.getSelection&&document.createRange){var n=0,i=document.createRange();i.setStart(t,0),i.collapse(!0);for(var r,o=[t],l=!1,d=!1;!d&&(r=o.pop());)if(3===r.nodeType){var s=n+r.length;!l&&a.start>=n&&a.start<=s&&(i.setStart(r,a.start-n),l=!0),l&&a.end>=n&&a.end<=s&&(i.setEnd(r,a.end-n),d=!0),n=s}else for(var c=r.childNodes.length;c--;)o.push(r.childNodes[c]);var p=window.getSelection();p.removeAllRanges(),p.addRange(i)}}function d(t,a){if(9!==a.keyCode)return!1;var n;if(t.getSelection&&(n=t.getSelection(),n.rangeCount>0)){var i=null,r=null;if(a.shiftKey?(r="previous",i="TD"===n.focusNode.nodeName?null!=n.focusNode.previousSibling?n.focusNode.previousSibling:null!=n.focusNode.parentNode.previousSibling?n.focusNode.parentNode.previousSibling.childNodes[n.focusNode.parentNode.previousSibling.childNodes.length-1]:null:null!=n.focusNode.parentNode.previousSibling?n.focusNode.parentNode.previousSibling:null!=n.focusNode.parentNode.parentNode.previousSibling?n.focusNode.parentNode.parentNode.previousSibling.childNodes[n.focusNode.parentNode.parentNode.previousSibling.childNodes.length-1]:null):(r="next",i="TD"===n.focusNode.nodeName?null!=n.focusNode.nextSibling?n.focusNode.nextSibling:null!=n.focusNode.parentNode.nextSibling?n.focusNode.parentNode.nextSibling.childNodes[0]:null:null!=n.focusNode.parentNode.nextSibling?n.focusNode.parentNode.nextSibling:null!=n.focusNode.parentNode.parentNode.nextSibling?n.focusNode.parentNode.parentNode.nextSibling.childNodes[0]:null),null!=i)return n.collapse(i,Math.min(i.length,n.focusOffset+1)),null!=i.textContent&&n.selectAllChildren(i),a.preventDefault(),!0;if(null===i&&"next"===r&&"TD"===n.focusNode.nodeName){for(var o=e(n.focusNode).parents("table"),l=o.find("tr").first().children("td").length,s=e("<tr />"),c=e("<td />"),p=1;l>=p;p++)s.append(c.clone());o.append(s),d(window,{keyCode:9,shiftKey:!1,preventDefault:function(){}})}}return!1}function s(){var e;return window.getSelection?(e=window.getSelection(),e.toString()):document.selection.createRange?(e=document.selection.createRange(),e.text):!1}function c(t){var a=e(".richText-editor#"+t).siblings(".richText-initial");p(a.val()),k=o(t)}function p(e){le.length-1>de&&(le.length=de+1),le[le.length-1]!==e&&le.push(e),de=le.length-1,h()}function h(){0>=de?L.find(".richText-undo").addClass("is-disabled"):L.find(".richText-undo").removeClass("is-disabled"),de>=le.length-1||0===le.length?L.find(".richText-redo").addClass("is-disabled"):L.find(".richText-redo").removeClass("is-disabled")}function f(){de--;var e=le[de];L.find("textarea").val(e),L.find(".richText-editor").html(e),h()}function u(){de++;var e=le[de];L.find("textarea").val(e),L.find(".richText-editor").html(e),h()}function m(){k&&l(k.editorID)}function g(e){var t,a;if(window.getSelection){if(t=window.getSelection(),t.getRangeAt&&t.rangeCount){a=t.getRangeAt(0),a.deleteContents();var n=document.createElement("div");n.innerHTML=e;for(var i,r,o=document.createDocumentFragment();i=n.firstChild;)r=o.appendChild(i);a.insertNode(o),r&&(a=a.cloneRange(),a.setStartAfter(r),a.collapse(!0),t.removeAllRanges(),t.addRange(a))}}else document.selection&&"Control"!==document.selection.type&&document.selection.createRange().pasteHTML(e)}function v(e){if(!e)return"";var t,a;return S.useSingleQuotes===!0?(t=/\s+(\w+\s*=\s*(["][^"]*["])|(['][^']*[']))+/g,a=e.replace(t,function(e,t,a){return a?e.replace(a,a.replace(/\"/g,"'")):e})):(t=/\s+(\w+\s*=\s*(['][^']*['])|(["][^"]*["]))+/g,a=e.replace(t,function(e,t,a){return a?e.replace(a,a.replace(/'/g,'"')):e})),a}function x(e){var t=[],a="";t["#FFFFFF"]="White",t["#000000"]="Black",t["#7F6000"]="Brown",t["#938953"]="Beige",t["#1F497D"]="Dark Blue",t.blue="Blue",t["#4F81BD"]="Light blue",t["#953734"]="Dark red",t.red="Red",t["#4F6128"]="Dark green",t.green="Green",t["#3F3151"]="Purple",t["#31859B"]="Dark Turquois",t["#4BACC6"]="Turquois",t["#E36C09"]="Dark orange",t["#F79646"]="Orange",t["#FFFF00"]="Yellow",S.colors&&S.colors.length>0&&(t=S.colors);for(var n in t)a+='<li class="inline"><a data-command="'+e+'" data-option="'+n+'" style="text-align:left;" title="'+t[n]+'"><span class="box-color" style="background-color:'+n+'"></span></a></li>';return a}function b(t){m(),L.find(".richText-editor").is(":visible")?(L.find(".richText-initial").show(),L.find(".richText-editor").hide(),e(".richText-toolbar").find(".richText-btn").each(function(){e(this).hasClass("fa-code")||e(this).parent("li").attr("data-disable","true")}),T(t,k)):(L.find(".richText-initial").hide(),L.find(".richText-editor").show(),T(t,k,!0),e(".richText-toolbar").find("li").removeAttr("data-disable"))}function T(t,a,n){var i=e("#"+t),r=i.siblings(".richText-initial"),o=r.val();if(!a||!o)return{start:0,end:0};if(n===!0)return k={start:i.text().length,end:i.text().length,editorID:t},l(t),!0;a.node=r[0];for(var d={start:!1,end:!1,tag:!1,isTag:!1,tagsCount:0,isHighlight:a.start!==a.end},s=0;s<o.length;s++)"<"===o[s]?(d.isTag=!0,d.tag=!1,d.tagsCount++):d.isTag===!0&&">"!==o[s]?d.tagsCount++:d.isTag===!0&&">"===o[s]?(d.isTag=!1,d.tag=!0,d.tagsCount++):d.tag===!0&&(d.tag=!1),n||(a.start+d.tagsCount<=s&&d.isHighlight&&!d.isTag&&!d.tag&&!d.start?(a.start=s,d.start=!0):!(a.start+d.tagsCount<=s+1)||d.isHighlight||d.isTag||d.tag||d.start||(a.start=s+1,d.start=!0),a.end+d.tagsCount<=s+1&&!d.isTag&&!d.tag&&!d.end&&(a.end=s+1,d.end=!0));return w(a.node,a.start,a.end),a}function w(e,t,a){if(e.createTextRange){var n=e.createTextRange();n.collapse(!0),n.moveStart("character",t),n.moveEnd("character",a),n.select(),e.focus()}else e.setSelectionRange?(e.focus(),e.setSelectionRange(t,a)):"undefined"!=typeof e.selectionStart&&(e.selectionStart=t,e.selectionEnd=a,e.focus())}function C(e,t){var a=N(e),n=!1,i=!1;if(!a)return!1;t?"responsive"!==t?t=t.split("x"):(n=!0,t="640x360",t=t.split("x")):(t="640x360",t=t.split("x"));var r="<br><br>";n===!0&&(r+='<div style="position:relative;height:0;padding-bottom:56.25%">');var o="webkitallowfullscreen mozallowfullscreen allowfullscreen";return"YouTube"===a.platform?(r+='<iframe src="https://www.youtube.com/embed/'+a.id+'?ecver=2" width="'+t[0]+'" height="'+t[1]+'" frameborder="0"'+(n===!0?' style="position:absolute;width:100%;height:100%;left:0"':"")+" "+o+"></iframe>",i=!0):"Vimeo"===a.platform?(r+='<iframe src="https://player.vimeo.com/video/'+a.id+'" width="'+t[0]+'" height="'+t[1]+'" frameborder="0"'+(n===!0?' style="position:absolute;width:100%;height:100%;left:0"':"")+" "+o+"></iframe>",i=!0):"Facebook"===a.platform?(r+='<iframe src="https://www.facebook.com/plugins/video.php?href='+encodeURI(e)+"&show_text=0&width="+t[0]+'" width="'+t[0]+'" height="'+t[1]+'" style="'+(n===!0?'position:absolute;width:100%;height:100%;left:0;border:none;overflow:hidden"':"border:none;overflow:hidden")+'" scrolling="no" frameborder="0" allowTransparency="true" '+o+"></iframe>",i=!0):"Dailymotion"===a.platform&&(r+='<iframe frameborder="0" width="'+t[0]+'" height="'+t[1]+'" src="//www.dailymotion.com/embed/video/'+a.id+'"'+(n===!0?' style="position:absolute;width:100%;height:100%;left:0"':"")+" "+o+"></iframe>",i=!0),n===!0&&(r+="</div>"),r+="<br><br>",i?r:!1}function N(e){var t=/(?:http?s?:\/\/)?(?:www\.)?(?:vimeo\.com)\/?(.+)/,a=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/,n=/(?:http?s?:\/\/)?(?:www\.)?(?:facebook\.com)\/.*\/videos\/[0-9]+/,i=/(?:http?s?:\/\/)?(?:www\.)?(?:dailymotion\.com)\/video\/([a-zA-Z0-9]+)/,r=e.match(a),o=e.match(t),l=e.match(n),d=e.match(i);return r&&11===r[2].length?{platform:"YouTube",id:r[2]}:o&&o[1]?{platform:"Vimeo",id:o[1]}:l&&l[0]?{platform:"Facebook",id:l[0]}:d&&d[1]?{platform:"Dailymotion",id:d[1]}:!1}function y(){L&&!L.find(".richText-editor").html()&&(S.useParagraph!==!1?L.find(".richText-editor").html("<p><br></p>"):L.find(".richText-editor").html("<div><br></div>"),i())}var S=e.extend({bold:!0,italic:!0,underline:!0,leftAlign:!0,centerAlign:!0,rightAlign:!0,ol:!0,ul:!0,heading:!0,fonts:!0,fontList:["Arial","Arial Black","Comic Sans MS","Courier New","Geneva","Georgia","Helvetica","Impact","Lucida Console","Tahoma","Times New Roman","Verdana"],fontColor:!0,imageUpload:!0,fileUpload:!0,videoEmbed:!0,urls:!0,table:!0,removeStyles:!0,code:!0,colors:[],fileHTML:"",imageHTML:"",useSingleQuotes:!1,height:0,heightPercentage:0,id:"",class:"",useParagraph:!1},t),R=e(this);R.addClass("richText-initial");var L,k,U=e("<ul />"),D=e("<li />"),A=e("<a />",{class:"richText-btn fa fa-bold","data-command":"bold"}),F=e("<a />",{class:"richText-btn fa fa-italic","data-command":"italic"}),H=e("<a />",{class:"richText-btn fa fa-underline","data-command":"underline"}),I=e("<a />",{class:"richText-btn fa fa-align-left","data-command":"justifyLeft"}),B=e("<a />",{class:"richText-btn fa fa-align-center","data-command":"justifyCenter"}),M=e("<a />",{class:"richText-btn fa fa-align-right","data-command":"justifyRight"}),E=e("<a />",{class:"richText-btn fa fa-list-ol","data-command":"insertOrderedList"}),P=e("<a />",{class:"richText-btn fa fa-list","data-command":"insertUnorderedList"}),W=e("<a />",{class:"richText-btn fa fa-header"}),X=e("<a />",{class:"richText-btn fa fa-font"}),Y=e("<a />",{class:"richText-btn fa fa-paint-brush"}),Q=e("<a />",{class:"richText-btn fa fa-image"}),z=e("<a />",{class:"richText-btn fa fa-video-camera"}),_=e("<a />",{class:"richText-btn fa fa-file-text-o"}),V=e("<a />",{class:"richText-btn fa fa-link"}),G=e("<a />",{class:"richText-btn fa fa-table"}),O=e("<a />",{class:"richText-btn fa fa-recycle","data-command":"removeFormat"}),j=e("<a />",{class:"richText-btn fa fa-code","data-command":"toggleCode"}),q=e("<div />",{class:"richText-dropdown-outer"}),K=e("<span />",{class:"richText-dropdown-close",html:'<span class="fa fa-times"></span>'}),Z=e("<ul />",{class:"richText-dropdown"}),$=e("<div />",{class:"richText-dropdown"}),J=e("<div />",{class:"richText-form"}),ee=e("<div />",{class:"richText-form-item"}),te=e("<label />"),ae=e("<input />",{type:"text"}),ne=(e("<input />",{type:"file"}),e("<select />")),ie=e("<button />",{text:"Einfügen",class:"btn"}),re="richText-"+Math.random().toString(36).substring(7),oe=null,le=[],de=0,se=Z.clone();se.append(e("<li />",{html:'<a data-command="formatBlock" data-option="h1">Title #1</a>'})),se.append(e("<li />",{html:'<a data-command="formatBlock" data-option="h2">Title #2</a>'})),se.append(e("<li />",{html:'<a data-command="formatBlock" data-option="h3">Title #3</a>'})),se.append(e("<li />",{html:'<a data-command="formatBlock" data-option="h4">Title #4</a>'})),W.append(q.clone().append(se.prepend(K.clone())));for(var ce=S.fontList,pe=Z.clone(),he=0;he<ce.length;he++)pe.append(e("<li />",{html:'<a style="font-family:'+ce[he]+';" data-command="fontName" data-option="'+ce[he]+'">'+ce[he]+"</a>"}));X.append(q.clone().append(pe.prepend(K.clone())));var fe=Z.clone();fe.html(x("forecolor")),Y.append(q.clone().append(fe.prepend(K.clone())));var ue=$.clone(),me=J.clone().attr("id","richText-URL").attr("data-editor",re);me.append(ee.clone().append(te.clone().text("URL").attr("for","url")).append(ae.clone().attr("id","url"))),me.append(ee.clone().append(te.clone().text("Text").attr("for","urlText")).append(ae.clone().attr("id","urlText"))),me.append(ee.clone().append(te.clone().text("Open in").attr("for","openIn")).append(ne.clone().attr("id","openIn").append(e("<option />",{value:"_self",text:"Same tab"})).append(e("<option />",{value:"_blank",text:"New tab"})))),me.append(ee.clone().append(ie.clone())),ue.append(me),V.append(q.clone().append(ue.prepend(K.clone())));var ge=$.clone(),ve=J.clone().attr("id","richText-Video").attr("data-editor",re);ve.append(ee.clone().append(te.clone().text("URL").attr("for","videoURL")).append(ae.clone().attr("id","videoURL"))),ve.append(ee.clone().append(te.clone().text("Size").attr("for","size")).append(ne.clone().attr("id","size").append(e("<option />",{value:"responsive",text:"Responsive"})).append(e("<option />",{value:"640x360",text:"640x360"})).append(e("<option />",{value:"560x315",text:"560x315"})).append(e("<option />",{value:"480x270",text:"480x270"})).append(e("<option />",{value:"320x180",text:"320x180"})))),ve.append(ee.clone().append(ie.clone())),ge.append(ve),z.append(q.clone().append(ge.prepend(K.clone())));var xe=$.clone(),be=J.clone().attr("id","richText-Image").attr("data-editor",re);S.imageHTML&&(e(S.imageHTML).find("#imageURL").length>0||"imageURL"===e(S.imageHTML).attr("id"))?be.html(S.imageHTML):(be.append(ee.clone().append(te.clone().text("Image URL").attr("for","imageURL")).append(ae.clone().attr("id","imageURL"))),be.append(ee.clone().append(te.clone().text("Align").attr("for","align")).append(ne.clone().attr("id","align").append(e("<option />",{value:"left",text:"Left"})).append(e("<option />",{value:"center",text:"Center"})).append(e("<option />",{value:"right",text:"Right"}))))),be.append(ee.clone().append(ie.clone())),xe.append(be),Q.append(q.clone().append(xe.prepend(K.clone())));var Te=$.clone(),we=J.clone().attr("id","richText-File").attr("data-editor",re);S.fileHTML&&(e(S.fileHTML).find("#fileURL").length>0||"fileURL"===e(S.fileHTML).attr("id"))?we.html(S.fileHTML):(we.append(ee.clone().append(te.clone().text("File URL").attr("for","fileURL")).append(ae.clone().attr("id","fileURL"))),we.append(ee.clone().append(te.clone().text("Link text").attr("for","fileText")).append(ae.clone().attr("id","fileText")))),we.append(ee.clone().append(ie.clone())),Te.append(we),_.append(q.clone().append(Te.prepend(K.clone())));var Ce=$.clone(),Ne=J.clone().attr("id","richText-Table").attr("data-editor",re);return Ne.append(ee.clone().append(te.clone().text("Rows").attr("for","tableRows")).append(ae.clone().attr("id","tableRows").attr("type","number"))),Ne.append(ee.clone().append(te.clone().text("Columns").attr("for","tableColumns")).append(ae.clone().attr("id","tableColumns").attr("type","number"))),Ne.append(ee.clone().append(ie.clone())),Ce.append(Ne),G.append(q.clone().append(Ce.prepend(K.clone()))),a(),L.find(".richText-help").on("click",function(){var t=e(this).parents(".richText");if(t){var a=e("<div />",{class:"richText-help-popup",style:"position:absolute;top:0;right:0;bottom:0;left:0;background-color: rgba(0,0,0,0.3);"}),n=e("<div />",{style:"position:relative;margin:60px auto;padding:20px;background-color:#FAFAFA;width:70%;font-family:Calibri,Verdana,Helvetica,sans-serif;font-size:small;"}),i=e("<div />",{html:'<span id="closeHelp" style="display:block;position:absolute;top:0;right:0;padding:10px;cursor:pointer;" class="fa fa-times" title="Close"></span>'});i.append("<h3>RichText</h3>"),i.append('<hr>Powered by <a href="https://github.com/webfashionist/RichText" target="_blank">webfashionist/RichText</a> (Github) <br>License: <a href="https://github.com/webfashionist/RichText/blob/master/LICENSE" target="_blank">AGPL-3.0</a>'),a.append(n.append(i)),t.append(a),a.on("click","#closeHelp",function(){e(this).parents(".richText-help-popup").remove()})}}),e(document).on("click",".richText-undo, .richText-redo",function(t){var a=e(this);a.hasClass("richText-undo")&&!a.hasClass("is-disabled")?f():a.hasClass("richText-redo")&&!a.hasClass("is-disabled")&&u()}),e(document).on("input change blur keydown",".richText-editor",function(t){return 9!==t.keyCode&&"9"!==t.keyCode||"keydown"!==t.type?(y(),i(),void c(e(this).attr("id"))):(t.preventDefault(),d(window,t),!1)}),e(document).on("input change blur",".richText-initial",function(){S.useSingleQuotes===!0&&e(this).val(v(e(this).val()));var t=e(this).siblings(".richText-editor").attr("id");r(t),c(t)}),e(document).on("dblclick mouseup",".richText-editor",function(){var t=e(this).attr("id");c(t)}),e(document).on("click","#richText-Video button.btn",function(t){t.preventDefault();var a=e(this),n=a.parent(".richText-form-item").parent(".richText-form");if(n.attr("data-editor")===re){var r=n.find("input#videoURL").val(),o=n.find("select#size").val();if(r){var d="";d=C(r,o),d?(S.useSingleQuotes===!0,l(re),g(d),i(),n.find("input#videoURL").val(""),e(".richText-toolbar li.is-selected").removeClass("is-selected")):(n.prepend(e("<div />",{style:"color:red;display:none;",class:"form-item is-error",text:"Video URL not supported"})),n.children(".form-item.is-error").slideDown(),setTimeout(function(){n.children(".form-item.is-error").slideUp(function(){e(this).remove()})},5e3))}else n.prepend(e("<div />",{style:"color:red;display:none;",class:"form-item is-error",text:"Please enter an URL"})),n.children(".form-item.is-error").slideDown(),setTimeout(function(){n.children(".form-item.is-error").slideUp(function(){e(this).remove()})},5e3)}}),e(document).on("mousedown",function(t){var a=e(t.target);if("IMG"===a.prop("tagName")&&a.parents("#"+re)){startX=t.pageX,startY=t.pageY,startW=a.innerWidth(),startH=a.innerHeight();var n=(a.offset().left,a.offset().left+a.innerWidth()),i=a.offset().top+a.innerHeight(),r=(a.offset().top,!1);a.css({cursor:"default"}),startY<=i&&startY>=i-20&&startX>=n-20&&startX<=n&&(oe=a,oe.css({cursor:"nwse-resize"}),r=!0),r!==!0&&!oe||oe.data("width")?r===!0||oe?t.preventDefault():oe=null:(oe.data("width",a.parents("#"+re).innerWidth()),oe.data("height",3*a.parents("#"+re).innerHeight()),t.preventDefault())}}),e(document).mouseup(function(){oe&&oe.css({cursor:"default"}),oe=null}).mousemove(function(e){if(null!==oe){var t=oe.data("width"),a=oe.width(),n=oe.data("height"),r=oe.height();startW+e.pageX-startX<=t&&startH+e.pageY-startY<=n?(oe.innerWidth(startW+e.pageX-startX),i()):startW+e.pageX-startX<=a&&startH+e.pageY-startY<=r&&(oe.innerWidth(startW+e.pageX-startX),i())}}),e(document).on("click","#richText-URL button.btn",function(t){t.preventDefault();var a=e(this),n=a.parent(".richText-form-item").parent(".richText-form");if(n.attr("data-editor")===re){var i=n.find("input#url").val(),r=n.find("input#urlText").val(),o=n.find("#openIn").val();if(o||(o="_self"),r||(r=i),i){var d="";d=S.useSingleQuotes===!0?"<a href='"+i+"' target='"+o+"'>"+r+"</a>":'<a href="'+i+'" target="'+o+'">'+r+"</a>",l(re),g(d),n.find("input#url").val(""),n.find("input#urlText").val(""),e(".richText-toolbar li.is-selected").removeClass("is-selected")}else n.prepend(e("<div />",{style:"color:red;display:none;",class:"form-item is-error",text:"Please enter an URL"})),n.children(".form-item.is-error").slideDown(),setTimeout(function(){n.children(".form-item.is-error").slideUp(function(){e(this).remove()})},5e3)}}),e(document).on("click","#richText-Image button.btn",function(t){t.preventDefault();var a=e(this),n=a.parent(".richText-form-item").parent(".richText-form");if(n.attr("data-editor")===re){var i=n.find("#imageURL").val(),r=n.find("select#align").val();if(r||(r="center"),i){var o="";o=S.useSingleQuotes===!0?"center"===r?"<div style='text-align:center;'><img src='"+i+"'></div>":"<img src='"+i+"' align='"+r+"'>":"center"===r?'<div style="text-align:center;"><img src="'+i+'"></div>':'<img src="'+i+'" align="'+r+'">',l(re),g(o),n.find("input#imageURL").val(""),e(".richText-toolbar li.is-selected").removeClass("is-selected")}else n.prepend(e("<div />",{style:"color:red;display:none;",class:"form-item is-error",text:"Please select an image."})),n.children(".form-item.is-error").slideDown(),setTimeout(function(){n.children(".form-item.is-error").slideUp(function(){e(this).remove()})},5e3)}}),e(document).on("click","#richText-File button.btn",function(t){t.preventDefault();var a=e(this),n=a.parent(".richText-form-item").parent(".richText-form");if(n.attr("data-editor")===re){var i=n.find("#fileURL").val(),r=n.find("#fileText").val();if(r||(r=i),i){var o="";o=S.useSingleQuotes===!0?"<a href='"+i+"' target='_blank'>"+r+"</a>":'<a href="'+i+'" target="_blank">'+r+"</a>",l(re),g(o),n.find("input#fileURL").val(""),n.find("input#fileText").val(""),e(".richText-toolbar li.is-selected").removeClass("is-selected")}else n.prepend(e("<div />",{style:"color:red;display:none;",class:"form-item is-error",text:"Please select a file."})),n.children(".form-item.is-error").slideDown(),setTimeout(function(){n.children(".form-item.is-error").slideUp(function(){e(this).remove()})},5e3)}}),e(document).on("click","#richText-Table button.btn",function(t){t.preventDefault();var a=e(this),n=a.parent(".richText-form-item").parent(".richText-form");if(n.attr("data-editor")===re){var i=n.find("input#tableRows").val(),r=n.find("input#tableColumns").val();(!i||0>=i)&&(i=2),(!r||0>=r)&&(r=2);var o="";o=S.useSingleQuotes===!0?"<table class='table-1'><tbody>":'<table class="table-1"><tbody>';for(var d=1;i>=d;d++){o+="<tr>";for(var s=1;r>=s;s++)o+="<td> </td>";o+="</tr>"}o+="</tbod></table>",l(re),g(o),n.find("input#tableColumns").val(""),n.find("input#tableRows").val(""),e(".richText-toolbar li.is-selected").removeClass("is-selected")}}),e(document).on("click",function(t){var a=e(t.target);if(0===a.parents(".richText-toolbar").length);else if(a.hasClass("richText-dropdown-outer"))a.parent("a").parent("li").removeClass("is-selected");else if(a.find(".richText").length>0)e(".richText-toolbar li").removeClass("is-selected");else if(a.parent().hasClass("richText-dropdown-close"))e(".richText-toolbar li").removeClass("is-selected");else if(a.hasClass("richText-btn")&&e(t.target).children(".richText-dropdown-outer").length>0)if(a.parent("li").addClass("is-selected"),a.hasClass("fa-link")){l(re);var n=s();a.find("input#urlText").val(""),a.find("input#url").val(""),n&&a.find("input#urlText").val(n)}else a.hasClass("fa-image")}),e(document).on("click",".richText-toolbar a[data-command]",function(t){var a=e(this),i=a.closest(".richText-toolbar"),r=i.siblings(".richText-editor"),o=r.attr("id");if(r.length>0&&o===re&&(!a.parent("li").attr("data-disable")||"false"===a.parent("li").attr("data-disable"))){t.preventDefault();var l=e(this).data("command");if("toggleCode"===l)b(r.attr("id"));else{var d=null;e(this).data("option")&&(d=e(this).data("option"),d.match(/^h[1-6]$/)&&(l="heading")),n(l,d),"removeFormat"===l&&n("formatBlock","div")}}a.parents("li.is-selected").removeClass("is-selected")}),e(this)}}(jQuery);
function MarkerClusterer(map,opt_markers,opt_options){this.extend(MarkerClusterer,google.maps.OverlayView);this.map_=map;this.markers_=[];this.clusters_=[];this.sizes=[53,56,66,78,90];this.styles_=[];this.ready_=false;var options=opt_options||{};this.gridSize_=options["gridSize"]||60;this.minClusterSize_=options["minimumClusterSize"]||2;this.maxZoom_=options["maxZoom"]||null;this.styles_=options["styles"]||[];this.imagePath_=options["imagePath"]||this.MARKER_CLUSTER_IMAGE_PATH_;this.imageExtension_=options["imageExtension"]||this.MARKER_CLUSTER_IMAGE_EXTENSION_;this.zoomOnClick_=true;if(options["zoomOnClick"]!=undefined){this.zoomOnClick_=options["zoomOnClick"]}this.averageCenter_=false;if(options["averageCenter"]!=undefined){this.averageCenter_=options["averageCenter"]}this.setupStyles_();this.setMap(map);this.prevZoom_=this.map_.getZoom();var that=this;google.maps.event.addListener(this.map_,"zoom_changed",function(){var zoom=that.map_.getZoom();var minZoom=that.map_.minZoom||0;var maxZoom=Math.min(that.map_.maxZoom||100,that.map_.mapTypes[that.map_.getMapTypeId()].maxZoom);zoom=Math.min(Math.max(zoom,minZoom),maxZoom);if(that.prevZoom_!=zoom){that.prevZoom_=zoom;that.resetViewport()}});google.maps.event.addListener(this.map_,"idle",function(){that.redraw()});if(opt_markers&&(opt_markers.length||Object.keys(opt_markers).length)){this.addMarkers(opt_markers,false)}}MarkerClusterer.prototype.MARKER_CLUSTER_IMAGE_PATH_="../images/m";MarkerClusterer.prototype.MARKER_CLUSTER_IMAGE_EXTENSION_="png";MarkerClusterer.prototype.extend=function(obj1,obj2){return function(object){for(var property in object.prototype){this.prototype[property]=object.prototype[property]}return this}.apply(obj1,[obj2])};MarkerClusterer.prototype.onAdd=function(){this.setReady_(true)};MarkerClusterer.prototype.draw=function(){};MarkerClusterer.prototype.setupStyles_=function(){if(this.styles_.length){return}for(var i=0,size;size=this.sizes[i];i++){this.styles_.push({url:this.imagePath_+(i+1)+"."+this.imageExtension_,height:size,width:size})}};MarkerClusterer.prototype.fitMapToMarkers=function(){var markers=this.getMarkers();var bounds=new google.maps.LatLngBounds;for(var i=0,marker;marker=markers[i];i++){bounds.extend(marker.getPosition())}this.map_.fitBounds(bounds)};MarkerClusterer.prototype.setStyles=function(styles){this.styles_=styles};MarkerClusterer.prototype.getStyles=function(){return this.styles_};MarkerClusterer.prototype.isZoomOnClick=function(){return this.zoomOnClick_};MarkerClusterer.prototype.isAverageCenter=function(){return this.averageCenter_};MarkerClusterer.prototype.getMarkers=function(){return this.markers_};MarkerClusterer.prototype.getTotalMarkers=function(){return this.markers_.length};MarkerClusterer.prototype.setMaxZoom=function(maxZoom){this.maxZoom_=maxZoom};MarkerClusterer.prototype.getMaxZoom=function(){return this.maxZoom_};MarkerClusterer.prototype.calculator_=function(markers,numStyles){var index=0;var count=markers.length;var dv=count;while(dv!==0){dv=parseInt(dv/10,10);index++}index=Math.min(index,numStyles);return{text:count,index:index}};MarkerClusterer.prototype.setCalculator=function(calculator){this.calculator_=calculator};MarkerClusterer.prototype.getCalculator=function(){return this.calculator_};MarkerClusterer.prototype.addMarkers=function(markers,opt_nodraw){if(markers.length){for(var i=0,marker;marker=markers[i];i++){this.pushMarkerTo_(marker)}}else if(Object.keys(markers).length){for(var marker in markers){this.pushMarkerTo_(markers[marker])}}if(!opt_nodraw){this.redraw()}};MarkerClusterer.prototype.pushMarkerTo_=function(marker){marker.isAdded=false;if(marker["draggable"]){var that=this;google.maps.event.addListener(marker,"dragend",function(){marker.isAdded=false;that.repaint()})}this.markers_.push(marker)};MarkerClusterer.prototype.addMarker=function(marker,opt_nodraw){this.pushMarkerTo_(marker);if(!opt_nodraw){this.redraw()}};MarkerClusterer.prototype.removeMarker_=function(marker){var index=-1;if(this.markers_.indexOf){index=this.markers_.indexOf(marker)}else{for(var i=0,m;m=this.markers_[i];i++){if(m==marker){index=i;break}}}if(index==-1){return false}marker.setMap(null);this.markers_.splice(index,1);return true};MarkerClusterer.prototype.removeMarker=function(marker,opt_nodraw){var removed=this.removeMarker_(marker);if(!opt_nodraw&&removed){this.resetViewport();this.redraw();return true}else{return false}};MarkerClusterer.prototype.removeMarkers=function(markers,opt_nodraw){var removed=false;for(var i=0,marker;marker=markers[i];i++){var r=this.removeMarker_(marker);removed=removed||r}if(!opt_nodraw&&removed){this.resetViewport();this.redraw();return true}};MarkerClusterer.prototype.setReady_=function(ready){if(!this.ready_){this.ready_=ready;this.createClusters_()}};MarkerClusterer.prototype.getTotalClusters=function(){return this.clusters_.length};MarkerClusterer.prototype.getMap=function(){return this.map_};MarkerClusterer.prototype.setMap=function(map){this.map_=map};MarkerClusterer.prototype.getGridSize=function(){return this.gridSize_};MarkerClusterer.prototype.setGridSize=function(size){this.gridSize_=size};MarkerClusterer.prototype.getMinClusterSize=function(){return this.minClusterSize_};MarkerClusterer.prototype.setMinClusterSize=function(size){this.minClusterSize_=size};MarkerClusterer.prototype.getExtendedBounds=function(bounds){var projection=this.getProjection();var tr=new google.maps.LatLng(bounds.getNorthEast().lat(),bounds.getNorthEast().lng());var bl=new google.maps.LatLng(bounds.getSouthWest().lat(),bounds.getSouthWest().lng());var trPix=projection.fromLatLngToDivPixel(tr);trPix.x+=this.gridSize_;trPix.y-=this.gridSize_;var blPix=projection.fromLatLngToDivPixel(bl);blPix.x-=this.gridSize_;blPix.y+=this.gridSize_;var ne=projection.fromDivPixelToLatLng(trPix);var sw=projection.fromDivPixelToLatLng(blPix);bounds.extend(ne);bounds.extend(sw);return bounds};MarkerClusterer.prototype.isMarkerInBounds_=function(marker,bounds){return bounds.contains(marker.getPosition())};MarkerClusterer.prototype.clearMarkers=function(){this.resetViewport(true);this.markers_=[]};MarkerClusterer.prototype.resetViewport=function(opt_hide){for(var i=0,cluster;cluster=this.clusters_[i];i++){cluster.remove()}for(var i=0,marker;marker=this.markers_[i];i++){marker.isAdded=false;if(opt_hide){marker.setMap(null)}}this.clusters_=[]};MarkerClusterer.prototype.repaint=function(){var oldClusters=this.clusters_.slice();this.clusters_.length=0;this.resetViewport();this.redraw();window.setTimeout(function(){for(var i=0,cluster;cluster=oldClusters[i];i++){cluster.remove()}},0)};MarkerClusterer.prototype.redraw=function(){this.createClusters_()};MarkerClusterer.prototype.distanceBetweenPoints_=function(p1,p2){if(!p1||!p2){return 0}var R=6371;var dLat=(p2.lat()-p1.lat())*Math.PI/180;var dLon=(p2.lng()-p1.lng())*Math.PI/180;var a=Math.sin(dLat/2)*Math.sin(dLat/2)+Math.cos(p1.lat()*Math.PI/180)*Math.cos(p2.lat()*Math.PI/180)*Math.sin(dLon/2)*Math.sin(dLon/2);var c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));var d=R*c;return d};MarkerClusterer.prototype.addToClosestCluster_=function(marker){var distance=4e4;var clusterToAddTo=null;var pos=marker.getPosition();for(var i=0,cluster;cluster=this.clusters_[i];i++){var center=cluster.getCenter();if(center){var d=this.distanceBetweenPoints_(center,marker.getPosition());if(d<distance){distance=d;clusterToAddTo=cluster}}}if(clusterToAddTo&&clusterToAddTo.isMarkerInClusterBounds(marker)){clusterToAddTo.addMarker(marker)}else{var cluster=new Cluster(this);cluster.addMarker(marker);this.clusters_.push(cluster)}};MarkerClusterer.prototype.createClusters_=function(){if(!this.ready_){return}var mapBounds=new google.maps.LatLngBounds(this.map_.getBounds().getSouthWest(),this.map_.getBounds().getNorthEast());var bounds=this.getExtendedBounds(mapBounds);for(var i=0,marker;marker=this.markers_[i];i++){if(!marker.isAdded&&this.isMarkerInBounds_(marker,bounds)){this.addToClosestCluster_(marker)}}};function Cluster(markerClusterer){this.markerClusterer_=markerClusterer;this.map_=markerClusterer.getMap();this.gridSize_=markerClusterer.getGridSize();this.minClusterSize_=markerClusterer.getMinClusterSize();this.averageCenter_=markerClusterer.isAverageCenter();this.center_=null;this.markers_=[];this.bounds_=null;this.clusterIcon_=new ClusterIcon(this,markerClusterer.getStyles(),markerClusterer.getGridSize())}Cluster.prototype.isMarkerAlreadyAdded=function(marker){if(this.markers_.indexOf){return this.markers_.indexOf(marker)!=-1}else{for(var i=0,m;m=this.markers_[i];i++){if(m==marker){return true}}}return false};Cluster.prototype.addMarker=function(marker){if(this.isMarkerAlreadyAdded(marker)){return false}if(!this.center_){this.center_=marker.getPosition();this.calculateBounds_()}else{if(this.averageCenter_){var l=this.markers_.length+1;var lat=(this.center_.lat()*(l-1)+marker.getPosition().lat())/l;var lng=(this.center_.lng()*(l-1)+marker.getPosition().lng())/l;this.center_=new google.maps.LatLng(lat,lng);this.calculateBounds_()}}marker.isAdded=true;this.markers_.push(marker);var len=this.markers_.length;if(len<this.minClusterSize_&&marker.getMap()!=this.map_){marker.setMap(this.map_)}if(len==this.minClusterSize_){for(var i=0;i<len;i++){this.markers_[i].setMap(null)}}if(len>=this.minClusterSize_){marker.setMap(null)}this.updateIcon();return true};Cluster.prototype.getMarkerClusterer=function(){return this.markerClusterer_};Cluster.prototype.getBounds=function(){var bounds=new google.maps.LatLngBounds(this.center_,this.center_);var markers=this.getMarkers();for(var i=0,marker;marker=markers[i];i++){bounds.extend(marker.getPosition())}return bounds};Cluster.prototype.remove=function(){this.clusterIcon_.remove();this.markers_.length=0;delete this.markers_};Cluster.prototype.getSize=function(){return this.markers_.length};Cluster.prototype.getMarkers=function(){return this.markers_};Cluster.prototype.getCenter=function(){return this.center_};Cluster.prototype.calculateBounds_=function(){var bounds=new google.maps.LatLngBounds(this.center_,this.center_);this.bounds_=this.markerClusterer_.getExtendedBounds(bounds)};Cluster.prototype.isMarkerInClusterBounds=function(marker){return this.bounds_.contains(marker.getPosition())};Cluster.prototype.getMap=function(){return this.map_};Cluster.prototype.updateIcon=function(){var zoom=this.map_.getZoom();var mz=this.markerClusterer_.getMaxZoom();if(mz&&zoom>mz){for(var i=0,marker;marker=this.markers_[i];i++){marker.setMap(this.map_)}return}if(this.markers_.length<this.minClusterSize_){this.clusterIcon_.hide();return}var numStyles=this.markerClusterer_.getStyles().length;var sums=this.markerClusterer_.getCalculator()(this.markers_,numStyles);this.clusterIcon_.setCenter(this.center_);this.clusterIcon_.setSums(sums);this.clusterIcon_.show()};function ClusterIcon(cluster,styles,opt_padding){cluster.getMarkerClusterer().extend(ClusterIcon,google.maps.OverlayView);this.styles_=styles;this.padding_=opt_padding||0;this.cluster_=cluster;this.center_=null;this.map_=cluster.getMap();this.div_=null;this.sums_=null;this.visible_=false;this.setMap(this.map_)}ClusterIcon.prototype.triggerClusterClick=function(){var markerClusterer=this.cluster_.getMarkerClusterer();google.maps.event.trigger(markerClusterer,"clusterclick",this.cluster_);if(markerClusterer.isZoomOnClick()){this.map_.fitBounds(this.cluster_.getBounds())}};ClusterIcon.prototype.onAdd=function(){this.div_=document.createElement("DIV");if(this.visible_){var pos=this.getPosFromLatLng_(this.center_);this.div_.style.cssText=this.createCss(pos);this.div_.innerHTML=this.sums_.text}var panes=this.getPanes();panes.overlayMouseTarget.appendChild(this.div_);var that=this;google.maps.event.addDomListener(this.div_,"click",function(){that.triggerClusterClick()})};ClusterIcon.prototype.getPosFromLatLng_=function(latlng){var pos=this.getProjection().fromLatLngToDivPixel(latlng);pos.x-=parseInt(this.width_/2,10);pos.y-=parseInt(this.height_/2,10);return pos};ClusterIcon.prototype.draw=function(){if(this.visible_){var pos=this.getPosFromLatLng_(this.center_);this.div_.style.top=pos.y+"px";this.div_.style.left=pos.x+"px"}};ClusterIcon.prototype.hide=function(){if(this.div_){this.div_.style.display="none"}this.visible_=false};ClusterIcon.prototype.show=function(){if(this.div_){var pos=this.getPosFromLatLng_(this.center_);this.div_.style.cssText=this.createCss(pos);this.div_.style.display=""}this.visible_=true};ClusterIcon.prototype.remove=function(){this.setMap(null)};ClusterIcon.prototype.onRemove=function(){if(this.div_&&this.div_.parentNode){this.hide();this.div_.parentNode.removeChild(this.div_);this.div_=null}};ClusterIcon.prototype.setSums=function(sums){this.sums_=sums;this.text_=sums.text;this.index_=sums.index;if(this.div_){this.div_.innerHTML=sums.text}this.useStyle()};ClusterIcon.prototype.useStyle=function(){var index=Math.max(0,this.sums_.index-1);index=Math.min(this.styles_.length-1,index);var style=this.styles_[index];this.url_=style["url"];this.height_=style["height"];this.width_=style["width"];this.textColor_=style["textColor"];this.anchor_=style["anchor"];this.textSize_=style["textSize"];this.backgroundPosition_=style["backgroundPosition"]};ClusterIcon.prototype.setCenter=function(center){this.center_=center};ClusterIcon.prototype.createCss=function(pos){var style=[];style.push("background-image:url("+this.url_+");");var backgroundPosition=this.backgroundPosition_?this.backgroundPosition_:"0 0";style.push("background-position:"+backgroundPosition+";");if(typeof this.anchor_==="object"){if(typeof this.anchor_[0]==="number"&&this.anchor_[0]>0&&this.anchor_[0]<this.height_){style.push("height:"+(this.height_-this.anchor_[0])+"px; padding-top:"+this.anchor_[0]+"px;")}else{style.push("height:"+this.height_+"px; line-height:"+this.height_+"px;")}if(typeof this.anchor_[1]==="number"&&this.anchor_[1]>0&&this.anchor_[1]<this.width_){style.push("width:"+(this.width_-this.anchor_[1])+"px; padding-left:"+this.anchor_[1]+"px;")}else{style.push("width:"+this.width_+"px; text-align:center;")}}else{style.push("height:"+this.height_+"px; line-height:"+this.height_+"px; width:"+this.width_+"px; text-align:center;")}var txtColor=this.textColor_?this.textColor_:"black";var txtSize=this.textSize_?this.textSize_:11;style.push("cursor:pointer; top:"+pos.y+"px; left:"+pos.x+"px; color:"+txtColor+"; position:absolute; font-size:"+txtSize+"px; font-family:Arial,sans-serif; font-weight:bold");return style.join("")};
$(function(){var globalId=undefined;$(document).find("#friendForm").on("submit",function(e){e.preventDefault();var _formData=new FormData($(this)[0]),_url=Routing.generate("eco_job_anonymous_sendToFriend");if(globalId==undefined){return}console.log("sending");_formData.set("offreId",globalId);var _options={url:_url,method:"POST",processData:false,contentType:false,data:_formData,beforeSend:function(){$.blockUI({message:'<p class="loader"></p>',css:{border:"none",backgroundColor:"transparent",width:"66px",top:($(window).height()-100)/2+"px",left:($(window).width()-100)/2+"px"}})},error:function(err){$("#responseStore").addClass("alert-danger").html("Echec lors de l'envoie").show()},success:function(data){$(document).find("#friendModal").modal("hide")},complete:function(){$.unblockUI()}};$.ajax(_options)});$(document).find("#friendModal").on("shown.bs.modal",function(e){var _id=$(e.relatedTarget).data("url-id");globalId=_id});$(document).find("#friendModal").on("hidden.bs.modal",function(){globalId=undefined;$(this).find('[name="friendEmail"]').val("");$(this).find('[name="friendContent"]').val("");$("#responseStore").hide()})});